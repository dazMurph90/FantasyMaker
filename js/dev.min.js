var initCanvas={};console.log("Enter initCanvas.js");
var cy=cytoscape({container:document.getElementById("cy"),layout:{name:"grid",rows:1},style:[{selector:"node",style:{content:"data(id)","text-opacity":1,"text-valign":"center","text-halign":"center","border-width":5,"border-opacity":0}},{selector:"edge",style:{width:4,"target-arrow-shape":"triangle","line-color":"#9dbaea","target-arrow-color":"#9dbaea","curve-style":"bezier"}},{selector:":selected",style:{"border-opacity":1,"line-color":"black","target-arrow-color":"black"}},{selector:".page",style:{shape:"roundrectangle",
"background-color":"light-gray"}},{selector:".decision",style:{shape:"ellipse","background-color":"red"}}],elements:{nodes:[{data:{id:"a",text:"sample text 1"},classes:"page"},{data:{id:"b",text:"sample text 2"},classes:"decision"}],edges:[{data:{id:"edge-ab",source:"a",target:"b"}}]},selectionType:"single"});console.log("Canvas done");var ui={};states={DEFAULT:0,CONNECTING:1,NEWPAGE:2,NEWDECISION:3};current_state=states.DEFAULT;
function changeState(a){$("#sidebar .button").removeClass("activebutton");$(a).addClass("activebutton");$(a).hasClass("connectionmode")&&current_state!=states.CONNECTING?(current_state=states.CONNECTING,source_node=cy.$(":selected")):$(a).hasClass("pagemode")&&current_state!=states.NEWPAGE?current_state=states.NEWPAGE:$(a).hasClass("decisionmode")&&current_state!=states.NEWDECISION?current_state=states.NEWDECISION:(console.log("Deselect button"),current_state=states.DEFAULT,$(a).removeClass("activebutton"))}
$("#pagetext").on("input",function(a){a=this.value;cy.$(":selected").data("text",a);console.log("For element ",cy.$(":selected").data("id"),"apply",this.value," Now holds: ",cy.$(":selected").data("text"))});var interactCanvas={};console.log("Enter interactCanvas.js");total_pages=0;
cy.on("tap",function(a){var b=a.cyTarget;current_state===states.CONNECTING&&cy.$(":selected").empty()&&(console.log("USER: please select a valid node to connect to"),source_node.select());current_state===states.NEWPAGE?b===cy&&cy.add({data:{id:++total_pages,text:"new element text"},group:"nodes",renderedPosition:a.cyRenderedPosition,classes:"page"}):current_state===states.NEWDECISION&&b===cy&&cy.add({data:{id:++total_pages},group:"nodes",renderedPosition:a.cyRenderedPosition,classes:"decision"})});
cy.on("select",function(a){a=cy.$(":selected");$(".connectionmode").show();console.log("Select: ",a.data("id"));current_state==states.CONNECTING&&(console.log("Creating link from ",source_node.data("id")," to ",a.data("id")),source_node.data("id")!=a.data("id")&&(cy.add({data:{source:source_node.data("id"),target:a.data("id")},group:"edges"}),source_node=cy.$(":selected")));a.hasClass("decision")?($("#editdecision").show(),$("#decisionname").text("Decision "+a.data("id"))):a.hasClass("page")&&($("#editpage").show(),
$("#pagename").text("Page "+a.data("id")),document.getElementById("pagetext").value=a.data("text"))});cy.on("unselect",function(a){cy.$(":selected").empty()&&(console.log("No element selected"),$("#editpage").hide(),$("#editdecision").hide(),$(".connectionmode").hide())});console.log("Enter main.js");
